(()=>{var e=!1;function t(t){e=!e,document.querySelector("#modalText").innerText=t,e?modal.classList.remove("hidden"):modal.classList.add("hidden")}let o=document.querySelector("#copyQuery");o.addEventListener("click",(()=>{!async function(e,t){await navigator.clipboard.writeText(t),e.innerText="Copied!",await new Promise((e=>setTimeout(e,3e3))),e.innerText="Copy"}(o,document.querySelector("#generatedQuery").innerText)}));let n=document.querySelector("#form");n.addEventListener("submit",(async e=>{e.preventDefault(),e.stopPropagation();for(const e of n.elements)e.disabled=!0;let o=document.querySelector("#submit");o.innerText="Please Wait...";let r={username:document.querySelector("#username").value,password:document.querySelector("#password").value,host:document.querySelector("#host").value,port:parseInt(document.querySelector("#port").value),dbname:document.querySelector("#dbname").value,question:document.querySelector("#query").value};const l=JSON.stringify(r);try{let e=await fetch("/query/build",{method:"POST",body:l,headers:{"Content-Type":"application/json"}}),o=await e.json();console.log(o),o.ok?document.querySelector("#generatedQuery").innerHTML=o.message:(console.log("show the goddamn error modal"),t(`Unable to build the query: ${o.message}`),setTimeout((()=>t("error")),5e3))}catch(e){t(`Unable to build the query: ${e}`),setTimeout((()=>t("error")),5e3)}finally{for(const e of n.elements)e.disabled=!1;o.innerText="Submit"}}));let r=document.getElementById("runQuery");r.addEventListener("click",(async()=>{for(const e of n.elements)e.disabled=!0;let e=document.querySelector("#submit");e.innerText="Please Wait...",r.disabled=!0,r.innerText="Please Wait...";let o={username:document.querySelector("#username").value,password:document.querySelector("#password").value,host:document.querySelector("#host").value,port:parseInt(document.querySelector("#port").value),dbname:document.querySelector("#dbname").value,query:document.querySelector("#generatedQuery").innerText};const l=JSON.stringify(o);try{let e=await fetch("/query/execute",{method:"POST",body:l,headers:{"Content-Type":"application/json"}}),o=await e.json();console.log(o),o.ok?(function(e){let t=document.createElement("table");for(let o=0;o<e.length;o++){const n=e[o];let r=document.createElement("tr");for(let e=0;e<n.length;e++){const t=n[e];let o=document.createElement("td");o.innerText=t,r.appendChild(o),console.log(o)}console.log(r),t.appendChild(r)}let o=document.querySelector("#outputTable");o.innerText="",o.appendChild(t)}(o.results),document.querySelector("#generatedQuery").innerHTML=o.message):(t(`Unable to execute the query: ${o.message}`),setTimeout((()=>t("error")),5e3))}catch(e){t(`Unable to execute the query: ${e}`),setTimeout((()=>t("error")),5e3)}finally{for(const e of n.elements)e.disabled=!1;e.innerText="Submit",r.disabled=!1,r.innerText="Execute Query"}}))})();