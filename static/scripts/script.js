(()=>{var e=!1;function t(t){e=!e,document.querySelector("#modalText").innerText=t,e?modal.classList.remove("hidden"):modal.classList.add("hidden")}let n=document.querySelector("#copyQuery");function o(){return{username:document.querySelector("#username").value,password:document.querySelector("#password").value,host:document.querySelector("#host").value,port:parseInt(document.querySelector("#port").value),dbname:document.querySelector("#dbname").value,question:document.querySelector("#query").value,query:document.querySelector("#generatedQuery").innerText}}function r(){for(const e of a.elements)e.disabled=!0;document.querySelector("#submit").innerText="Please Wait..."}function l(){for(const e of a.elements)e.disabled=!1;document.querySelector("#submit").innerText="Submit"}n.addEventListener("click",(()=>{!async function(e,t){await navigator.clipboard.writeText(t),e.innerText="Copied!",setTimeout((()=>{e.innerText="Copy Query"}),3e3)}(n,document.querySelector("#generatedQuery").innerText)}));let a=document.querySelector("#form");a.addEventListener("submit",(async e=>{e.preventDefault(),e.stopPropagation(),r();let n=o();const a=JSON.stringify(n);try{let e=await fetch("/query/build",{method:"POST",body:a,headers:{"Content-Type":"application/json"}}),n=await e.json();console.log(n),n.ok?document.querySelector("#generatedQuery").innerHTML=n.message:(console.log("show the goddamn error modal"),t(`Unable to build the query: ${n.message}`),setTimeout((()=>t("error")),5e3))}catch(e){t(`Unable to build the query: ${e}`),setTimeout((()=>t("error")),5e3)}finally{l()}}));let u=document.getElementById("runQuery");u.addEventListener("click",(async()=>{r(),u.disabled=!0,u.innerText="Please Wait...";let e=o();const n=JSON.stringify(e);try{let e=await fetch("/query/execute",{method:"POST",body:n,headers:{"Content-Type":"application/json"}}),o=await e.json();console.log(o),o.ok?function(e,t){let n=document.createElement("table");if(n.classList.add(..."table table-zebra".split(" ")),e){let t=document.createElement("tr");e.forEach((e=>{const n=document.createElement("th");n.innerText=e,t.appendChild(n)})),n.appendChild(t)}for(let e=0;e<t.length;e++){const o=t[e];let r=document.createElement("tr");for(let e=0;e<o.length;e++){const t=o[e];let n=document.createElement("td");n.innerText=t,r.appendChild(n),console.log(n)}console.log(r),n.appendChild(r)}let o=document.querySelector("#outputTable");o.innerText="",o.appendChild(n)}(o.headings,o.rows):(t(`Unable to execute the query: ${o.message}`),setTimeout((()=>t("error")),5e3))}catch(e){t(`Unable to execute the query: ${e}`),setTimeout((()=>t("error")),5e3)}finally{l(),u.disabled=!1,u.innerText="Execute Query"}}))})();