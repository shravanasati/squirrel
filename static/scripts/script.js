(()=>{var e=!1;function t(t){e=!e,document.querySelector("#modalText").innerText=t,e?modal.classList.remove("hidden"):modal.classList.add("hidden")}let o=document.querySelector("#copyQuery");o.addEventListener("click",(()=>{!async function(e,t){await navigator.clipboard.writeText(t),e.innerText="Copied!",await new Promise((e=>setTimeout(e,3e3))),e.innerText="Copy"}(o,document.querySelector("#generatedQuery").innerText)}));let n=document.querySelector("#form");n.addEventListener("submit",(async e=>{e.preventDefault(),e.stopPropagation();for(const e of n.elements)e.disabled=!0;let o=document.querySelector("#submit");o.innerText="Please Wait...";let r={username:document.querySelector("#username").value,password:document.querySelector("#password").value,host:document.querySelector("#host").value,port:parseInt(document.querySelector("#port").value),dbname:document.querySelector("#dbname").value,question:document.querySelector("#query").value};const a=JSON.stringify(r);try{let e=await fetch("/query/build",{method:"POST",body:a,headers:{"Content-Type":"application/json"}}),o=await e.json();console.log(o),o.ok?document.querySelector("#generatedQuery").innerHTML=o.message:(console.log("show the goddamn error modal"),t(`Unable to build the query: ${o.message}`),setTimeout((()=>t("error")),5e3))}catch(e){t(`Unable to build the query: ${e}`),setTimeout((()=>t("error")),5e3)}finally{for(const e of n.elements)e.disabled=!1;o.innerText="Submit"}}));let r=document.getElementById("runQuery");r.addEventListener("click",(async()=>{ev.preventDefault(),ev.stopPropagation();for(const e of n.elements)e.disabled=!0;submitBtn.innerText="Please Wait...",r.disabled=!0,r.innerText="Please Wait...";let e={username:document.querySelector("#username").value,password:document.querySelector("#password").value,host:document.querySelector("#host").value,port:parseInt(document.querySelector("#port").value),dbname:document.querySelector("#dbname").value,query:document.querySelector("#generatedQuery").value};const o=JSON.stringify(e);try{let e=await fetch("/query/execute",{method:"POST",body:o,headers:{"Content-Type":"application/json"}}),n=await e.json();console.log(n),n.ok?(function(e){let t=document.createElement("table");for(let o=0;o<e.length;o++){const n=e[o];let r=document.createElement("tr");for(let e=0;e<n.length;e++){const t=r[e];let o=document.createElement("td");o.innerText=t,r.appendChild(o)}t.appendChild(r)}document.querySelector("#outputTable").appendChild(t)}(n.results),document.querySelector("#generatedQuery").innerHTML=n.message):(t(`Unable to execute the query: ${n.message}`),setTimeout((()=>t("error")),5e3))}catch(e){t(`Unable to execute the query: ${e}`),setTimeout((()=>t("error")),5e3)}finally{for(const e of n.elements)e.disabled=!1;submitBtn.innerText="Submit",r.disabled=!1,r.innerText="Execute Query"}}))})();